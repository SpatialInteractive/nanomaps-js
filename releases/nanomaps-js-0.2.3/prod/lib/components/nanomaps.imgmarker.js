function makeAbsolute(b,a){if(a[0]==="/"||a.search(/^http(s)?\:/)>=0){return a}if(b.match(/\/$/)){return b+a}else{return b+"/"+a}}function hrefToClassSuffix(b){var c=b.lastIndexOf("/"),d=(c>=0?b.substring(c+1):b),a=d.match(/^([^_\-\.]+)/);return a?a[0]:b}function ImgMarker(a){this.settings=new SettingsConstructor(a);this.element=null;this.children=null}ImgMarker.Settings={src:"orb_blue.png",baseUri:"",location:null,classSuffix:"",extraClasses:""};ImgMarker.prototype={defaultLayer:"overlay",setLocation:function(d){d=Coordinate.from(d);var c=this.settings,b=this.element,a=this.owner;c.location=d;if(b){if(d){b.geo={latitude:d.lat(),longitude:d.lng()}}else{b.geo=null}if(a&&b.parentNode){a.update(b)}}},getElement:function(a){this.owner=a;if(this.element){return this.element}var e=a.elements.document,b=e.createElement("div"),c=e.createElement("img");b.appendChild(c);this.element=b;this.children={fg:c};this._config();return b},_config:function(){var f=this.settings,c=f.location,d=this.element,e=this.children.fg,a,b;a=makeAbsolute(f.baseUri||"",f.src||"");b=f.classSuffix||hrefToClassSuffix(a);d.className="nmim nmim-"+b+" "+f.extraClasses;if(c){d.geo={latitude:c.lat()||NaN,longitude:c.lng()||NaN}}else{d.geo=null}e.className="nmim-fg";e.setAttribute("src",a||null)}};function SettingsConstructor(b){if(b){for(var a in b){if(b.hasOwnProperty(a)){this[a]=b[a]}}}}SettingsConstructor.prototype=ImgMarker.Settings;exports.ImgMarker=ImgMarker;